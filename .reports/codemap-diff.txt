# Codemap 差异报告
生成时间: 2026-02-11 (第三次更新)

## 变更摘要

### 上次版本 (2026-02-06 v0.4.0)
- 项目版本: 0.4.0
- 核心代码: ~8889 行 (40 模块)
- 测试文件: 34 个 (~7742 行)

### 当前版本 (2026-02-11 v0.4.1)
- 项目版本: 0.4.1
- 核心代码: ~10817 行 (41 模块)
- 测试文件: 37 个 (~8709 行)
- 新增模块: core/backend/key_pool.py (91行)

## 差异比例

| 模块 | 上次行数 | 当前行数 | 变化 |
|------|---------|---------|------|
| main.py | 584 | 592 | +8 (+1.4%) |
| core/orchestrator.py | 1444 | 1626 | **+182 (+12.6%)** |
| core/evolution/solution_evolution.py | 287 | 329 | +42 (+14.6%) |
| utils/config.py | 603 | 607 | +4 (+0.7%) |
| core/backend/backend_openai.py | 163 | 165 | +2 |
| core/backend/backend_anthropic.py | 142 | 153 | +11 (+7.7%) |
| **core/backend/key_pool.py** | **N/A** | **91** | **+91 (NEW)** |
| utils/workspace_builder.py | 127 | 134 | +7 |

**总差异: ~15%** (低于 30% 阈值，自动更新)

## 主要变更

### 1. P0 修复: Orchestrator Metric 校验体系 (commit: 7fa4fa9, 5440633)
- 新增 `METRIC_BOUNDS` 字典（绝对范围检查）
- 新增 `_check_metric_plausibility()` 方法（异常值检测）
- 新增 `_validate_review_response()` 方法（响应一致性验证）
- Orchestrator 从 1444 行增长至 1626 行 (+12.6%)

### 2. P0 修复: Agent 验证策略强化 (commit: 5440633)
- 强制 K-Fold 交叉验证
- Metric 对齐检查（lower_is_better 一致性）
- is_buggy 判定条件增强（5 条件 OR）

### 3. P0 修复: SolutionEvolution lower_is_better (commit: e9cc087)
- 修复 metric 方向处理（支持 lower_is_better）
- solution_evolution.py 从 287 行增长至 329 行 (+14.6%)

### 4. 新增 API Key 池管理 (core/backend/key_pool.py)
- 91 行新模块
- API Key 循环使用，避免单个 Key 请求频率过高

### 5. 新增测试文件
- tests/unit/test_key_pool.py - API Key 池测试
- tests/unit/test_p0_fixes.py - P0 修复验证测试
- tests/integration/test_timeout.py - 超时集成测试

### 6. 文档新增
- docs/mle-bench-analysis-report.md - MLE-Bench 分析报告
- docs/plans/implementation_plan_p0.md - P0 实施计划

## Codemap 文档修正

| 文件 | 修正内容 |
|------|---------|
| architecture.md | 更新行数（Orchestrator/SolutionEvolution/main.py/config.py），新增 key_pool.py，更新总代码/测试统计，更新 Phase 状态 |
| backend.md | 更新行数（同上），新增 key_pool.py 模块条目，新增 Orchestrator 方法，更新测试列表 |
| data.md | 更新头部元数据（版本/行数/阶段） |
